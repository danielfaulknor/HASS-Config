- id: dryer_shed_rfid
  alias: Dryer Shed RFID
  trigger:
  - entity_id: binary_sensor.rpidryer_rfid
    from: 'off'
    platform: state
    to: 'on'
  action:
  - data:
      entity_id: lock.dryer_shed
    service: lock.unlock

- id: control_light_brightness
  alias: detect lights and adjust the brightness when turned on based on time
  trigger:
    - platform: event
      event_type: state_changed
  
  condition:
    - condition: state
      entity_id: input_boolean.alert_mode
      state: 'off'
    - condition: template
      value_template: "{{ trigger.event.data is not none }}"
    - condition: template
      value_template: "{{ trigger.event.data.entity_id is not none }}"
    - condition: template
      value_template: "{{ trigger.event.data.entity_id.split('.')[0] == 'light' }}"
    - condition: template
      value_template: "{{ trigger.event.data.new_state.state == 'on' }}"
    - condition: template
      value_template: "{{ trigger.event.data.old_state.state == 'off' }}"
   
  action:
    - service: light.turn_on
      data_template:
        entity_id: "{{ trigger.event.data.entity_id }}"
        brightness: >
          {% set hour=states("sensor.time").split(':')[0] | int %}
          {%- if hour >= 5 and hour < 8  -%}
            50
          {%- elif hour >= 8 and hour <20  -%}
            255
          {%- elif hour >= 20 and hour <24  -%}
            40  
          {%- else -%}
            15
          {%- endif %}
